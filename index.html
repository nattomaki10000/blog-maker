<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Editor - nattomaki10000</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js" defer></script>
    <script src="https://esm.sh/css-doodle/css-doodle.min.js?raw"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <style>
        :root { --accent: #ff4a4a; --bg: #0a0c27; }
        
        body { 
            margin: 0; padding: 0; font-family: 'Poppins', sans-serif; 
            background: var(--bg); color: #fff; min-height: 100vh; 
            display: flex; flex-direction: column; align-items: center; 
        }

        .background { position: fixed; inset: 0; z-index: -2; }

        /* ツールバーを最上部に固定 */
        .toolbar { 
            position: sticky; top: 0; width: 100%; 
            background: rgba(15, 15, 35, 0.95); 
            padding: 10px 0; display: flex; justify-content: center; flex-wrap: wrap; 
            gap: 10px; z-index: 1000; border-bottom: 1px solid var(--accent);
            -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px);
        }

        .tool-btn { 
            background: #222; border: 1px solid #444; color: #fff; 
            padding: 8px 12px; border-radius: 6px; cursor: pointer; 
            font-size: 14px; transition: 0.2s; 
        }
        .tool-btn:hover { background: var(--accent); border-color: var(--accent); }

        /* エディター本体 */
        .editor-container { width: 95%; max-width: 900px; margin: 40px 20px; z-index: 1; }
        
        .card { 
            background: rgba(255, 255, 255, 0.05); -webkit-backdrop-filter: blur(20px); backdrop-filter: blur(20px);
            border-radius: 15px; padding: 50px; border: 1px solid rgba(255, 74, 74, 0.2); 
            min-height: 80vh; box-shadow: 0 10px 50px rgba(0,0,0,0.5);
        }

        /* タイトル（サイズ固定） */
        .post-title { 
            font-size: 32px !important; color: var(--accent); margin-bottom: 5px; 
            border: none; background: transparent; width: 100%; outline: none; 
            font-weight: bold; display: block;
        }

        /* 日付 */
        .post-date {
            font-size: 14px; color: #888; margin-bottom: 30px;
            outline: none; display: block;
        }

        .editable { outline: none; line-height: 1.8; font-size: 1.1rem; color: #eee; }

        /* 引用のデザイン */
        blockquote {
            background: rgba(255, 74, 74, 0.1) !important;
            border-left: 5px solid var(--accent) !important;
            margin: 20px 0 !important;
            padding: 15px 25px !important;
            font-style: italic;
            color: #ddd;
        }

        .editable img { max-width: 100%; border-radius: 10px; margin: 20px 0; }

        /* フッターボタン */
        .footer-zone { margin: 40px 0; display: flex; flex-direction: column; align-items: center; gap: 20px; width: 100%; }
        
        .btn-main { 
            background: var(--accent); color: white; padding: 12px 30px; 
            border-radius: 50px; text-decoration: none; font-weight: bold;
            border: none; cursor: pointer; transition: 0.3s;
        }
        .btn-main:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(255, 74, 74, 0.4); }
        
        .btn-secondary { background: transparent; border: 1px solid #666; color: #888; font-size: 14px; }

        select, input[type="color"] { background: #222; color: #fff; border: 1px solid #444; padding: 5px; border-radius: 4px; }

        /* 隕石アニメーション */
        .inseki-container { position: fixed; inset: 0; z-index: -1; pointer-events: none; }
        .inseki::before { content: ""; position: absolute; width: 4px; height: 4px; background: transparent; box-shadow: 64px 4px 0 rgb(199, 0, 0), 48px 8px 0 rgb(255, 90, 0), 60px 8px 0 rgb(199, 0, 0), 32px 12px 0 rgb(235, 255, 37), 44px 12px 0 rgb(255, 90, 0), 56px 12px 0 rgb(199, 0, 0), 28px 16px 0 rgb(238, 255, 0), 40px 16px 0 rgb(255, 90, 0), 24px 20px 0 rgb(238, 255, 0), 48px 20px 0 rgb(199, 0, 0), 60px 20px 0 rgb(255, 75, 0), 32px 24px 0 rgb(255, 90, 0), 44px 24px 0 rgb(179, 0, 0), 56px 24px 0 rgb(255, 75, 0), 16px 28px 0 rgb(238, 255, 0), 28px 28px 0 rgb(255, 102, 0), 40px 28px 0 rgb(179, 0, 0), 52px 28px 0 rgb(255, 75, 0), 12px 32px 0 rgb(238, 255, 0), 24px 32px 0 rgb(255, 102, 0), 36px 32px 0 rgb(179, 0, 0), 12px 36px 0 rgb(133, 0, 0), 16px 36px 0 rgb(97, 39, 0), 20px 36px 0 rgb(133, 0, 0), 24px 36px 0 rgb(133, 0, 0), 32px 36px 0 rgb(179, 0, 0), 44px 36px 0 rgb(255, 75, 0), 56px 36px 0 rgb(235, 255, 37), 8px 40px 0 rgb(97, 39, 0), 12px 40px 0 rgb(97, 39, 0), 16px 40px 0 rgb(133, 0, 0), 20px 40px 0 rgb(133, 0, 0), 24px 40px 0 rgb(97, 39, 0), 28px 40px 0 rgb(97, 39, 0), 40px 40px 0 rgb(255, 75, 0), 52px 40px 0 rgb(235, 255, 37), 4px 44px 0 rgb(97, 39, 0), 8px 44px 0 rgb(97, 39, 0), 12px 44px 0 rgb(97, 39, 0), 16px 44px 0 rgb(97, 39, 0), 20px 44px 0 rgb(97, 39, 0), 24px 44px 0 rgb(133, 0, 0), 28px 44px 0 rgb(133, 0, 0), 32px 44px 0 rgb(97, 39, 0), 36px 44px 0 rgb(255, 75, 0), 48px 44px 0 rgb(235, 255, 37), 4px 48px 0 rgb(82, 16, 0), 8px 48px 0 rgb(82, 16, 0), 12px 48px 0 rgb(97, 39, 0), 16px 48px 0 rgb(97, 39, 0), 20px 48px 0 rgb(97, 39, 0), 24px 48px 0 rgb(97, 39, 0), 28px 48px 0 rgb(133, 0, 0), 32px 48px 0 rgb(97, 39, 0), 4px 52px 0 rgb(51, 10, 0), 8px 52px 0 rgb(82, 16, 0), 12px 52px 0 rgb(82, 16, 0), 16px 52px 0 rgb(97, 39, 0), 20px 52px 0 rgb(97, 39, 0), 24px 52px 0 rgb(97, 39, 0), 28px 52px 0 rgb(97, 39, 0), 32px 52px 0 rgb(133, 0, 0), 40px 52px 0 rgb(235, 255, 37), 4px 56px 0 rgb(51, 10, 0), 8px 56px 0 rgb(51, 10, 0), 12px 56px 0 rgb(82, 16, 0), 16px 56px 0 rgb(82, 16, 0), 20px 56px 0 rgb(97, 39, 0), 24px 56px 0 rgb(97, 39, 0), 28px 56px 0 rgb(97, 39, 0), 32px 56px 0 rgb(97, 39, 0), 36px 56px 0 rgb(235, 255, 37), 8px 60px 0 rgb(51, 10, 0), 12px 60px 0 rgb(51, 10, 0), 16px 60px 0 rgb(82, 16, 0), 20px 60px 0 rgb(82, 16, 0), 24px 60px 0 rgb(97, 39, 0), 28px 60px 0 rgb(97, 39, 0), 12px 64px 0 rgb(51, 10, 0), 16px 64px 0 rgb(51, 10, 0), 20px 64px 0 rgb(82, 16, 0), 24px 64px 0 rgb(97, 39, 0); }
        .animated { animation: inseki 4s infinite linear; }
        @keyframes inseki { 0% { transform: translate(100vw, -10vh) scale(1); opacity: 0; } 10% { opacity: 1; } 100% { transform: translate(-20vw, 110vh) scale(1.5); opacity: 0; } }

        @media (max-width: 768px) {
            .card { padding: 25px; }
            .post-title { font-size: 24px !important; }
        }
    </style>
</head>
<body>

    <div class="toolbar">
        <button class="tool-btn" onclick="exec('bold')"><i class="fas fa-bold"></i></button>
        <button class="tool-btn" onclick="addLink()"><i class="fas fa-link"></i></button>
        <button class="tool-btn" onclick="document.getElementById('imgInput').click()"><i class="fas fa-image"></i></button>
        <input type="file" id="imgInput" hidden accept="image/*" onchange="insertImage(this)">
        
        <select onchange="exec('fontSize', this.value)">
            <option value="3">サイズ: 中</option>
            <option value="1">極小</option>
            <option value="4">大</option>
            <option value="6">最大</option>
        </select>

        <input type="color" onchange="exec('foreColor', this.value)">
        <button class="tool-btn" onclick="exec('formatBlock', 'H2')">見出し</button>
        <button class="tool-btn" onclick="exec('formatBlock', 'blockquote')">引用</button>
        <button class="tool-btn" onclick="downloadAsZip()" style="background:var(--accent)"><i class="fas fa-file-archive"></i> ZIP保存</button>
    </div>

    <css-doodle click-to-update class="background">
        <style>@grid: 1 / 100vw 100vh / #0a0c27; background-size: 200px 200px; background-image: @doodle(@grid: 6 / 100%; @size: 4px; font-size: 4px; color: hsl(@r240, 30%, 50%); box-shadow: @m3x5(calc(4em - @nx * 1em) calc(@ny * 1em) @p(@m3(currentColor), @m2(transparent)), calc(2em + @nx * 1em) calc(@ny * 1em) @lp));</style>
    </css-doodle>
    <div class="inseki-container"><div class="animated inseki"></div></div>

    <div class="editor-container">
        <div class="card">
            <div id="post-title" class="post-title" contenteditable="true">記事のタイトル</div>
            <div id="post-date" class="post-date" contenteditable="true">2026年1月22日</div>
            
            <hr style="border:0; border-top:1px solid rgba(255,74,74,0.2); margin-bottom:20px;">

            <div id="editor" class="editable" contenteditable="true">
                <p>ここにブログの本文を書いてください。</p>
            </div>
        </div>

        <div class="footer-zone">
            <a href="https://nattomaki10000.github.io/" class="btn-main">
                <i class="fas fa-home"></i> トップページに戻る
            </a>
            <p style="color:#555; font-size:12px;">nattomaki10000 Blog System</p>
        </div>
    </div>

    <script>
        function exec(cmd, val = null) { document.execCommand(cmd, false, val); }

        function addLink() {
            const url = prompt("URLを入力してください:");
            if (url) exec('createLink', url);
        }

        function insertImage(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => exec('insertImage', e.target.result);
                reader.readAsDataURL(file);
            }
        }

        async function downloadAsZip() {
            const zip = new JSZip();
            let docClone = document.documentElement.cloneNode(true);
            
            // 書き出し用HTMLから不要なツールを削除
            docClone.querySelector('.toolbar').remove();
            docClone.querySelectorAll('[contenteditable]').forEach(el => el.removeAttribute('contenteditable'));

            const htmlContent = "<!DOCTYPE html>\n" + docClone.outerHTML;
            zip.file("index.html", htmlContent);
            
            const content = await zip.generateAsync({type:"blob"});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(content);
            a.download = "blog-post.zip";
            a.click();
        }

        // タイトル内での改行を禁止し、フォントサイズ変更を防ぐための簡易ガード
        document.getElementById('post-title').addEventListener('keydown', (e) => {
            if (e.key === 'Enter') e.preventDefault();
        });
    </script>
</body>
</html>
